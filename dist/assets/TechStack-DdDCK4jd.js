import{r as a,s as o,j as e,X as D}from"./index-CJfiuc-8.js";import{P as J,T as V}from"./trash-2-D7t-ir6P.js";import{S as X,a as H}from"./square-pen-C6b0hVzx.js";import{L as y}from"./loader-circle-BYE7sdF8.js";import{U as K}from"./upload-Ch6-rikk.js";import{S as Q}from"./save-CtBouC9b.js";const ne=()=>{const[x,j]=a.useState([]),[U,w]=a.useState(!0),[l,N]=a.useState(""),[v,k]=a.useState(null),[A,d]=a.useState(!1),[u,S]=a.useState(!1),[C,F]=a.useState(null),[i,f]=a.useState({name:"",category:"",proficiency:50}),[g,p]=a.useState(null),[T,m]=a.useState(""),[I,z]=a.useState(!1);a.useEffect(()=>{E()},[]);const E=async()=>{try{w(!0);const{data:s,error:r}=await o.from("tech_stack").select("*").order("category",{ascending:!0});if(r)throw r;j(s||[])}catch(s){console.error("Error fetching tech stack:",s)}finally{w(!1)}},O=async(s,r)=>{if(window.confirm("Are you sure you want to delete this tech stack item?"))try{if(k(s),r){const n=r.split("/").pop();await o.storage.from("tech-icons").remove([n])}const{error:t}=await o.from("tech_stack").delete().eq("id",s);if(t)throw t;j(x.filter(n=>n.id!==s))}catch(t){console.error("Error deleting tech stack item:",t)}finally{k(null)}},q=s=>{S(!0),F(s.id),f({name:s.name||"",category:s.category||"",proficiency:s.proficiency||50}),m(s.icon_url||""),d(!0)},$=()=>{S(!1),F(null),f({name:"",category:"",proficiency:50}),p(null),m(""),d(!0)},b=s=>{const{name:r,value:t}=s.target;f(n=>({...n,[r]:t}))},R=s=>{const r=s.target.files[0];if(!r)return;if(r.size>2*1024*1024){alert("File size must be less than 2MB");return}p(r);const t=new FileReader;t.onloadend=()=>{m(t.result)},t.readAsDataURL(r)},B=()=>{p(null),m("")},G=async s=>{var r;s.preventDefault();try{z(!0);let t=u&&((r=x.find(c=>c.id===C))==null?void 0:r.icon_url)||"";if(g){const c=g.name.split(".").pop(),L=`tech-icons/${`${Date.now()}_${Math.random().toString(36).substring(2)}.${c}`}`,{error:_}=await o.storage.from("tech-icons").upload(L,g);if(_)throw _;const{data:M}=o.storage.from("tech-icons").getPublicUrl(L);t=M.publicUrl}const n={name:i.name,category:i.category,proficiency:parseInt(i.proficiency),icon_url:t};let h;if(u){const{error:c}=await o.from("tech_stack").update(n).eq("id",C);h=c}else{const{error:c}=await o.from("tech_stack").insert([{...n,created_at:new Date().toISOString()}]);h=c}if(h)throw h;E(),d(!1)}catch(t){console.error("Error saving tech stack item:",t),alert("Failed to save tech stack item. Please try again.")}finally{z(!1)}},P=x.filter(s=>{var r,t;return((r=s.name)==null?void 0:r.toLowerCase().includes(l.toLowerCase()))||((t=s.category)==null?void 0:t.toLowerCase().includes(l.toLowerCase()))}).reduce((s,r)=>{const t=r.category||"Uncategorized";return s[t]||(s[t]=[]),s[t].push(r),s},{});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Tech Stack"}),e.jsxs("button",{onClick:$,className:"flex items-center px-4 py-2 bg-green-500/20 border border-green-500/30 rounded-lg text-green-400 hover:bg-green-500/30 transition-all",children:[e.jsx(J,{size:16,className:"mr-2"}),"Add New Tech"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(X,{size:18,className:"text-gray-500"})}),e.jsx("input",{type:"text",placeholder:"Search tech stack...",className:"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-green-500/50 focus:ring-1 focus:ring-green-500/30",value:l,onChange:s=>N(s.target.value)})]}),U?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx(y,{size:30,className:"animate-spin text-green-500"})}):Object.keys(P).length>0?e.jsx("div",{className:"space-y-8",children:Object.entries(P).map(([s,r])=>e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:s}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(t=>e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-4 hover:border-green-500/30 transition-all group",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 flex-shrink-0 bg-white/10 rounded-lg overflow-hidden flex items-center justify-center",children:t.icon_url?e.jsx("img",{src:t.icon_url,alt:t.name,className:"w-8 h-8 object-contain"}):e.jsx("span",{className:"text-gray-500 text-xs",children:"No Icon"})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("h3",{className:"text-white font-medium truncate",children:t.name}),e.jsx("div",{className:"mt-2 w-full bg-white/10 rounded-full h-1.5",children:e.jsx("div",{className:"bg-gradient-to-r from-green-400 to-emerald-500 h-1.5 rounded-full",style:{width:`${t.proficiency}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[e.jsx("span",{children:"Proficiency"}),e.jsxs("span",{children:[t.proficiency,"%"]})]})]})]}),e.jsxs("div",{className:"mt-4 flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>q(t),className:"p-1.5 bg-amber-500/20 rounded-md text-amber-400 hover:bg-amber-500/30 transition-colors",children:e.jsx(H,{size:16})}),e.jsx("button",{onClick:()=>O(t.id,t.icon_url),disabled:v===t.id,className:"p-1.5 bg-red-500/20 rounded-md text-red-400 hover:bg-red-500/30 transition-colors disabled:opacity-50",children:v===t.id?e.jsx(y,{size:16,className:"animate-spin"}):e.jsx(V,{size:16})})]})]},t.id))})]},s))}):e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-10 text-center",children:[e.jsx("p",{className:"text-gray-400",children:l?"No tech stack items match your search.":"No tech stack items found. Add your first tech!"}),l&&e.jsx("button",{onClick:()=>N(""),className:"mt-4 px-4 py-2 bg-green-500/20 border border-green-500/30 rounded-lg text-green-400 hover:bg-green-500/30 transition-all",children:"Clear Search"})]}),A&&e.jsx("div",{className:"fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-[#0a0a1a] border border-white/10 rounded-xl w-full max-w-md p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:u?"Edit Tech Stack Item":"Add New Tech Stack Item"}),e.jsx("button",{onClick:()=>d(!1),className:"p-1.5 bg-white/10 rounded-full text-gray-400 hover:bg-white/20 transition-colors",children:e.jsx(D,{size:18})})]}),e.jsxs("form",{onSubmit:G,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-300",children:["Technology Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",name:"name",value:i.name,onChange:b,required:!0,className:"mt-1 block w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-green-500/50 focus:ring-1 focus:ring-green-500/30",placeholder:"e.g. React, Python, Tailwind CSS"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-300",children:["Category ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"category",name:"category",value:i.category,onChange:b,required:!0,className:"mt-1 block w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-green-500/50 focus:ring-1 focus:ring-green-500/30",placeholder:"e.g. Frontend, Backend, DevOps"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"proficiency",className:"block text-sm font-medium text-gray-300",children:"Proficiency (%)"}),e.jsxs("div",{className:"mt-1 flex items-center space-x-4",children:[e.jsx("input",{type:"range",id:"proficiency",name:"proficiency",min:"0",max:"100",step:"5",value:i.proficiency,onChange:b,className:"w-full h-2 bg-white/10 rounded-lg appearance-none cursor-pointer accent-green-500"}),e.jsxs("span",{className:"text-white font-medium w-10 text-center",children:[i.proficiency,"%"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Icon"}),T?e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-white/10 rounded-lg flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:T,alt:"Icon preview",className:"w-12 h-12 object-contain"})}),e.jsx("button",{type:"button",onClick:B,className:"p-1.5 bg-red-500/20 rounded-md text-red-400 hover:bg-red-500/30 transition-colors",children:e.jsx(D,{size:16})})]}):e.jsx("div",{className:"flex items-center justify-center p-4 border-2 border-dashed border-white/10 rounded-lg",children:e.jsx("div",{className:"space-y-1 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(K,{className:"mx-auto h-8 w-8 text-gray-400"}),e.jsx("div",{className:"flex text-sm text-gray-400 mt-2",children:e.jsxs("label",{htmlFor:"icon-upload",className:"relative cursor-pointer rounded-md font-medium text-green-400 hover:text-green-300 focus-within:outline-none",children:[e.jsx("span",{children:"Upload an icon"}),e.jsx("input",{id:"icon-upload",name:"icon-upload",type:"file",className:"sr-only",accept:"image/*",onChange:R})]})}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"SVG, PNG, JPG up to 2MB"})]})})})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{type:"submit",disabled:I,className:"flex items-center px-6 py-2 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg text-white font-medium hover:from-green-600 hover:to-emerald-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:I?e.jsxs(e.Fragment,{children:[e.jsx(y,{size:18,className:"mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Q,{size:18,className:"mr-2"}),"Save"]})})})]})]})})]})};export{ne as default};
