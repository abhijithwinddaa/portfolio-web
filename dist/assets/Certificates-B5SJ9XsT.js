import{r as i,s as o,j as e,L as h}from"./index-CJfiuc-8.js";import{P as w,T as N}from"./trash-2-D7t-ir6P.js";import{S as y,a as v}from"./square-pen-C6b0hVzx.js";import{L as f}from"./loader-circle-BYE7sdF8.js";import{E as C}from"./external-link-_A4Qop02.js";const E=()=>{const[n,c]=i.useState([]),[g,d]=i.useState(!0),[a,m]=i.useState(""),[u,p]=i.useState(null);i.useEffect(()=>{b()},[]);const b=async()=>{try{d(!0);const{data:s,error:r}=await o.from("certificates").select("*").order("created_at",{ascending:!1});if(r)throw r;c(s||[])}catch(s){console.error("Error fetching certificates:",s)}finally{d(!1)}},j=async(s,r)=>{if(window.confirm("Are you sure you want to delete this certificate?"))try{if(p(s),r){const l=r.split("/").pop();await o.storage.from("certificate-images").remove([l])}const{error:t}=await o.from("certificates").delete().eq("id",s);if(t)throw t;c(n.filter(l=>l.id!==s))}catch(t){console.error("Error deleting certificate:",t)}finally{p(null)}},x=n.filter(s=>{var r,t;return((r=s.title)==null?void 0:r.toLowerCase().includes(a.toLowerCase()))||((t=s.issuer)==null?void 0:t.toLowerCase().includes(a.toLowerCase()))});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Certificates"}),e.jsxs(h,{to:"/admin/certificates/new",className:"flex items-center px-4 py-2 bg-purple-500/20 border border-purple-500/30 rounded-lg text-purple-400 hover:bg-purple-500/30 transition-all",children:[e.jsx(w,{size:16,className:"mr-2"}),"Add New Certificate"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(y,{size:18,className:"text-gray-500"})}),e.jsx("input",{type:"text",placeholder:"Search certificates...",className:"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-purple-500/50 focus:ring-1 focus:ring-purple-500/30",value:a,onChange:s=>m(s.target.value)})]}),g?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx(f,{size:30,className:"animate-spin text-purple-500"})}):x.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(s=>e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl overflow-hidden hover:border-purple-500/30 transition-all group",children:[e.jsxs("div",{className:"relative",children:[s.image_url?e.jsx("img",{src:s.image_url,alt:s.title,className:"w-full h-48 object-cover"}):e.jsx("div",{className:"w-full h-48 bg-white/10 flex items-center justify-center text-gray-500",children:"No Image"}),e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex items-end justify-between p-4",children:[e.jsx("div",{children:s.credential_url&&e.jsxs("a",{href:s.credential_url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center px-3 py-1.5 bg-purple-500/80 rounded-md text-white text-sm hover:bg-purple-600 transition-colors",children:[e.jsx(C,{size:14,className:"mr-1"}),"View Credential"]})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(h,{to:`/admin/certificates/edit/${s.id}`,className:"p-1.5 bg-amber-500/80 rounded-md text-white hover:bg-amber-600 transition-colors",children:e.jsx(v,{size:16})}),e.jsx("button",{onClick:()=>j(s.id,s.image_url),disabled:u===s.id,className:"p-1.5 bg-red-500/80 rounded-md text-white hover:bg-red-600 transition-colors disabled:opacity-50",children:u===s.id?e.jsx(f,{size:16,className:"animate-spin"}):e.jsx(N,{size:16})})]})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-white font-medium truncate",children:s.title}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:s.issuer||"Unknown issuer"}),s.issue_date&&e.jsxs("p",{className:"text-gray-500 text-xs mt-2",children:["Issued: ",new Date(s.issue_date).toLocaleDateString()]})]})]},s.id))}):e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-10 text-center",children:[e.jsx("p",{className:"text-gray-400",children:a?"No certificates match your search.":"No certificates found. Add your first certificate!"}),a&&e.jsx("button",{onClick:()=>m(""),className:"mt-4 px-4 py-2 bg-purple-500/20 border border-purple-500/30 rounded-lg text-purple-400 hover:bg-purple-500/30 transition-all",children:"Clear Search"})]})]})};export{E as default};
