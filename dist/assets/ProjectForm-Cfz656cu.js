import{u as B,e as G,r as l,s as c,j as e,X as P}from"./index-CJfiuc-8.js";import{L as S}from"./loader-circle-BYE7sdF8.js";import{A as M}from"./arrow-left-fT0_t5ia.js";import{U as $}from"./upload-Ch6-rikk.js";import{P as C,T as X}from"./trash-2-D7t-ir6P.js";import{S as H}from"./save-CtBouC9b.js";const Z=()=>{const{id:d}=B(),f=G(),u=!!d,[s,o]=l.useState({title:"",description:"",tech_stack:[],features:[],live_url:"",github_url:"",image_url:""}),[h,b]=l.useState(null),[j,x]=l.useState(""),[v,y]=l.useState(!1),[E,w]=l.useState(u),[g,N]=l.useState(""),[p,_]=l.useState("");l.useEffect(()=>{u&&z()},[d]);const z=async()=>{try{w(!0);const{data:t,error:r}=await c.from("projects").select("*").eq("id",d).single();if(r)throw r;t&&(o({title:t.title||"",description:t.description||"",tech_stack:t.tech_stack||[],features:t.features||[],live_url:t.live_url||"",github_url:t.github_url||"",image_url:t.image_url||""}),t.image_url&&x(t.image_url))}catch(t){console.error("Error fetching project:",t)}finally{w(!1)}},m=t=>{const{name:r,value:i}=t.target;o(a=>({...a,[r]:i}))},L=t=>{const r=t.target.files[0];if(!r)return;if(r.size>5*1024*1024){alert("File size must be less than 5MB");return}b(r);const i=new FileReader;i.onloadend=()=>{x(i.result)},i.readAsDataURL(r)},D=()=>{b(null),x(""),o(t=>({...t,image_url:""}))},U=()=>{g.trim()&&(o(t=>({...t,tech_stack:[...t.tech_stack,g.trim()]})),N(""))},T=t=>{o(r=>({...r,tech_stack:r.tech_stack.filter((i,a)=>a!==t)}))},I=()=>{p.trim()&&(o(t=>({...t,features:[...t.features,p.trim()]})),_(""))},A=t=>{o(r=>({...r,features:r.features.filter((i,a)=>a!==t)}))},R=async t=>{t.preventDefault();try{y(!0);let r=s.image_url;if(h){const n=h.name.split(".").pop(),k=`${Date.now()}_${Math.random().toString(36).substring(2)}.${n}`,{error:F}=await c.storage.from("project-images").upload(k,h);if(F)throw F;const{data:q}=c.storage.from("project-images").getPublicUrl(k);r=q.publicUrl}const i={title:s.title,description:s.description,tech_stack:s.tech_stack,features:s.features,live_url:s.live_url,github_url:s.github_url,image_url:r};let a;if(u){const{error:n}=await c.from("projects").update(i).eq("id",d);a=n}else{const{error:n}=await c.from("projects").insert([{...i,created_at:new Date().toISOString()}]);a=n}if(a)throw a;f("/admin/projects")}catch(r){console.error("Error saving project:",r),alert("Failed to save project. Please try again.")}finally{y(!1)}};return E?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx(S,{size:30,className:"animate-spin text-indigo-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:()=>f("/admin/projects"),className:"flex items-center text-gray-400 hover:text-white transition-colors",children:[e.jsx(M,{size:20,className:"mr-2"}),"Back to Projects"]}),e.jsx("h1",{className:"text-2xl font-bold text-white",children:u?"Edit Project":"Add New Project"})]}),e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Project Image"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-dashed border-white/10 rounded-lg",children:j?e.jsxs("div",{className:"space-y-4 w-full",children:[e.jsxs("div",{className:"relative mx-auto w-full max-w-md",children:[e.jsx("img",{src:j,alt:"Project preview",className:"h-64 w-full object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:D,className:"absolute top-2 right-2 p-1.5 bg-red-500/80 rounded-full text-white hover:bg-red-600 transition-colors",children:e.jsx(P,{size:16})})]}),e.jsx("div",{className:"text-center text-sm text-gray-400",children:"Click the X to remove the image or upload a new one"})]}):e.jsx("div",{className:"space-y-1 text-center",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx($,{className:"mx-auto h-12 w-12 text-gray-400"}),e.jsxs("div",{className:"flex text-sm text-gray-400 mt-2",children:[e.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer rounded-md font-medium text-indigo-400 hover:text-indigo-300 focus-within:outline-none",children:[e.jsx("span",{children:"Upload a file"}),e.jsx("input",{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",accept:"image/*",onChange:L})]}),e.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG, GIF up to 5MB"})]})})})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-300",children:["Project Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"title",name:"title",value:s.title,onChange:m,required:!0,className:"mt-1 block w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30",placeholder:"Enter project title"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-300",children:["Project Description ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"description",name:"description",value:s.description,onChange:m,required:!0,rows:4,className:"mt-1 block w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30",placeholder:"Enter project description"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tech Stack"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:s.tech_stack.map((t,r)=>e.jsxs("div",{className:"flex items-center bg-indigo-500/20 text-indigo-300 px-3 py-1.5 rounded-full text-sm",children:[t,e.jsx("button",{type:"button",onClick:()=>T(r),className:"ml-2 text-indigo-300 hover:text-indigo-100",children:e.jsx(P,{size:14})})]},r))}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",value:g,onChange:t=>N(t.target.value),className:"flex-1 px-4 py-2 bg-white/5 border border-white/10 rounded-l-lg text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30",placeholder:"Add technology"}),e.jsx("button",{type:"button",onClick:U,className:"px-4 py-2 bg-indigo-500/20 border border-indigo-500/30 rounded-r-lg text-indigo-400 hover:bg-indigo-500/30 transition-all",children:e.jsx(C,{size:20})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Key Features"}),e.jsx("div",{className:"space-y-2 mb-3",children:s.features.map((t,r)=>e.jsxs("div",{className:"flex items-center justify-between bg-white/5 px-4 py-2 rounded-lg",children:[e.jsx("span",{className:"text-gray-300",children:t}),e.jsx("button",{type:"button",onClick:()=>A(r),className:"text-red-400 hover:text-red-300",children:e.jsx(X,{size:16})})]},r))}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",value:p,onChange:t=>_(t.target.value),className:"flex-1 px-4 py-2 bg-white/5 border border-white/10 rounded-l-lg text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30",placeholder:"Add feature"}),e.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 bg-indigo-500/20 border border-indigo-500/30 rounded-r-lg text-indigo-400 hover:bg-indigo-500/30 transition-all",children:e.jsx(C,{size:20})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"live_url",className:"block text-sm font-medium text-gray-300",children:"Live Demo URL"}),e.jsx("input",{type:"url",id:"live_url",name:"live_url",value:s.live_url,onChange:m,className:"mt-1 block w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30",placeholder:"https://example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"github_url",className:"block text-sm font-medium text-gray-300",children:"GitHub URL"}),e.jsx("input",{type:"url",id:"github_url",name:"github_url",value:s.github_url,onChange:m,className:"mt-1 block w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30",placeholder:"https://github.com/username/repo"})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:v,className:"flex items-center px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-lg text-white font-medium hover:from-indigo-600 hover:to-purple-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:v?e.jsxs(e.Fragment,{children:[e.jsx(S,{size:20,className:"mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{size:20,className:"mr-2"}),"Save Project"]})})})]})]})};export{Z as default};
