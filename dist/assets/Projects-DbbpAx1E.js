import{r as i,s as o,j as e,L as u}from"./index-CJfiuc-8.js";import{P as w,T as N}from"./trash-2-D7t-ir6P.js";import{S as y,a as v}from"./square-pen-C6b0hVzx.js";import{L as g}from"./loader-circle-BYE7sdF8.js";import{E as k}from"./external-link-_A4Qop02.js";import{G as L}from"./github-BhE1FX5L.js";const T=()=>{const[n,d]=i.useState([]),[f,c]=i.useState(!0),[a,x]=i.useState(""),[m,h]=i.useState(null);i.useEffect(()=>{b()},[]);const b=async()=>{try{c(!0);const{data:s,error:t}=await o.from("projects").select("*").order("created_at",{ascending:!1});if(t)throw t;d(s||[])}catch(s){console.error("Error fetching projects:",s)}finally{c(!1)}},j=async(s,t)=>{if(window.confirm("Are you sure you want to delete this project?"))try{if(h(s),t){const l=t.split("/").pop();await o.storage.from("project-images").remove([l])}const{error:r}=await o.from("projects").delete().eq("id",s);if(r)throw r;d(n.filter(l=>l.id!==s))}catch(r){console.error("Error deleting project:",r)}finally{h(null)}},p=n.filter(s=>{var t,r;return((t=s.title)==null?void 0:t.toLowerCase().includes(a.toLowerCase()))||((r=s.description)==null?void 0:r.toLowerCase().includes(a.toLowerCase()))});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Projects"}),e.jsxs(u,{to:"/admin/projects/new",className:"flex items-center px-4 py-2 bg-indigo-500/20 border border-indigo-500/30 rounded-lg text-indigo-400 hover:bg-indigo-500/30 transition-all",children:[e.jsx(w,{size:16,className:"mr-2"}),"Add New Project"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(y,{size:18,className:"text-gray-500"})}),e.jsx("input",{type:"text",placeholder:"Search projects...",className:"w-full pl-10 pr-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30",value:a,onChange:s=>x(s.target.value)})]}),f?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx(g,{size:30,className:"animate-spin text-indigo-500"})}):p.length>0?e.jsx("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-white/5 border-b border-white/10",children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Image"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Title"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Links"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-white/10",children:p.map(s=>{var t;return e.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.title,className:"h-12 w-20 object-cover rounded-md border border-white/20"}):e.jsx("div",{className:"h-12 w-20 bg-white/10 rounded-md flex items-center justify-center text-gray-500 text-xs",children:"No Image"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-white",children:s.title}),e.jsx("div",{className:"text-xs text-gray-400",children:((t=s.tech_stack)==null?void 0:t.join(", "))||"No tech stack"})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-300 line-clamp-2 max-w-xs",children:s.description||"No description"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex space-x-2",children:[s.live_url&&e.jsx("a",{href:s.live_url,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 bg-blue-500/20 rounded-md text-blue-400 hover:bg-blue-500/30 transition-colors",children:e.jsx(k,{size:16})}),s.github_url&&e.jsx("a",{href:s.github_url,target:"_blank",rel:"noopener noreferrer",className:"p-1.5 bg-purple-500/20 rounded-md text-purple-400 hover:bg-purple-500/30 transition-colors",children:e.jsx(L,{size:16})})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(u,{to:`/admin/projects/edit/${s.id}`,className:"p-1.5 bg-amber-500/20 rounded-md text-amber-400 hover:bg-amber-500/30 transition-colors",children:e.jsx(v,{size:16})}),e.jsx("button",{onClick:()=>j(s.id,s.image_url),disabled:m===s.id,className:"p-1.5 bg-red-500/20 rounded-md text-red-400 hover:bg-red-500/30 transition-colors disabled:opacity-50",children:m===s.id?e.jsx(g,{size:16,className:"animate-spin"}):e.jsx(N,{size:16})})]})})]},s.id)})})]})})}):e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-10 text-center",children:[e.jsx("p",{className:"text-gray-400",children:a?"No projects match your search.":"No projects found. Add your first project!"}),a&&e.jsx("button",{onClick:()=>x(""),className:"mt-4 px-4 py-2 bg-indigo-500/20 border border-indigo-500/30 rounded-lg text-indigo-400 hover:bg-indigo-500/30 transition-all",children:"Clear Search"})]})]})};export{T as default};
