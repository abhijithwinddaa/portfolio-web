import{r as t,s as o,j as e,X as z}from"./index-CJfiuc-8.js";import{L as D}from"./loader-circle-BYE7sdF8.js";import{U as $}from"./user-DkuYxp9o.js";import{U as p}from"./upload-Ch6-rikk.js";import{S as A}from"./save-CtBouC9b.js";const X=()=>{const[I,y]=t.useState(!0),[N,v]=t.useState(!1),[s,m]=t.useState({name:"",title:"",bio:"",about_me:"",email:"",phone:"",location:"",resume_url:"",profile_image:""}),[f,C]=t.useState(null),[x,h]=t.useState(""),[b,F]=t.useState(null),[k,j]=t.useState("");t.useEffect(()=>{R()},[]);const R=async()=>{try{y(!0);const{data:r,error:i}=await o.from("profile").select("*").single();if(i&&i.code!=="PGRST116")throw i;if(r&&(m(r),r.profile_image&&h(r.profile_image),r.resume_url)){const l=r.resume_url.split("/").pop();j(l)}}catch(r){console.error("Error fetching profile:",r)}finally{y(!1)}},a=r=>{const{name:i,value:l}=r.target;m(u=>({...u,[i]:l}))},P=r=>{const i=r.target.files[0];if(!i)return;if(i.size>5*1024*1024){alert("File size must be less than 5MB");return}C(i);const l=new FileReader;l.onloadend=()=>{h(l.result)},l.readAsDataURL(i)},_=r=>{const i=r.target.files[0];if(i){if(i.size>10*1024*1024){alert("File size must be less than 10MB");return}F(i),j(i.name)}},U=()=>{C(null),h(""),m(r=>({...r,profile_image:""}))},E=()=>{F(null),j(""),m(r=>({...r,resume_url:""}))},M=async r=>{r.preventDefault();try{v(!0);let i=s.profile_image,l=s.resume_url;if(f){const n=f.name.split(".").pop(),d=`profile/${`profile_${Date.now()}.${n}`}`,{error:c}=await o.storage.from("profile-images").upload(d,f);if(c)throw c;const{data:w}=o.storage.from("profile-images").getPublicUrl(d);i=w.publicUrl}if(b){const n=b.name.split(".").pop(),d=`resumes/${`resume_${Date.now()}.${n}`}`,{error:c}=await o.storage.from("documents").upload(d,b);if(c)throw c;const{data:w}=o.storage.from("documents").getPublicUrl(d);l=w.publicUrl}const u={...s,profile_image:i,resume_url:l,updated_at:new Date().toISOString()},{data:S}=await o.from("profile").select("id").single();let g;if(S){const{error:n}=await o.from("profile").update(u).eq("id",S.id);g=n}else{const{error:n}=await o.from("profile").insert([{...u,created_at:new Date().toISOString()}]);g=n}if(g)throw g;alert("Profile saved successfully!")}catch(i){console.error("Error saving profile:",i),alert("Failed to save profile. Please try again.")}finally{v(!1)}};return I?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx(D,{size:30,className:"animate-spin text-indigo-500"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Profile"})}),e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Profile Image"}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-6",children:[e.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden bg-white/10 flex items-center justify-center",children:x?e.jsx("img",{src:x,alt:"Profile preview",className:"w-full h-full object-cover"}):e.jsx($,{size:40,className:"text-gray-400"})}),e.jsxs("div",{className:"flex-1 space-y-4",children:[x?e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{type:"button",onClick:U,className:"flex items-center px-4 py-2 bg-red-500/20 border border-red-500/30 rounded-lg text-red-400 hover:bg-red-500/30 transition-all",children:[e.jsx(z,{size:16,className:"mr-2"}),"Remove Image"]}),e.jsxs("label",{htmlFor:"profile-upload",className:"flex items-center px-4 py-2 bg-indigo-500/20 border border-indigo-500/30 rounded-lg text-indigo-400 hover:bg-indigo-500/30 transition-all cursor-pointer",children:[e.jsx(p,{size:16,className:"mr-2"}),"Change Image",e.jsx("input",{id:"profile-upload",name:"profile-upload",type:"file",className:"sr-only",accept:"image/*",onChange:P})]})]}):e.jsx("div",{children:e.jsxs("label",{htmlFor:"profile-upload",className:"flex items-center px-4 py-2 bg-indigo-500/20 border border-indigo-500/30 rounded-lg text-indigo-400 hover:bg-indigo-500/30 transition-all cursor-pointer inline-block",children:[e.jsx(p,{size:16,className:"mr-2"}),"Upload Profile Image",e.jsx("input",{id:"profile-upload",name:"profile-upload",type:"file",className:"sr-only",accept:"image/*",onChange:P})]})}),e.jsx("p",{className:"text-sm text-gray-400",children:"Recommended size: 500x500 pixels. Maximum file size: 5MB."})]})]})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-6 space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-300",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",name:"name",value:s.name,onChange:a,required:!0,className:"mt-1 block w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30",placeholder:"Your full name"})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-300",children:["Professional Title ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"title",name:"title",value:s.title,onChange:a,required:!0,className:"mt-1 block w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30",placeholder:"e.g. Frontend Developer"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-300",children:["Short Bio ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"bio",name:"bio",value:s.bio,onChange:a,required:!0,rows:2,className:"mt-1 block w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30",placeholder:"A brief introduction (1-2 sentences)"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"about_me",className:"block text-sm font-medium text-gray-300",children:"About Me"}),e.jsx("textarea",{id:"about_me",name:"about_me",value:s.about_me,onChange:a,rows:6,className:"mt-1 block w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30",placeholder:"Detailed information about yourself, your background, skills, and interests"})]})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-6 space-y-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300",children:"Email Address"}),e.jsx("input",{type:"email",id:"email",name:"email",value:s.email,onChange:a,className:"mt-1 block w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30",placeholder:"your.email@example.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-300",children:"Phone Number"}),e.jsx("input",{type:"tel",id:"phone",name:"phone",value:s.phone,onChange:a,className:"mt-1 block w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30",placeholder:"+1 (123) 456-7890"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-300",children:"Location"}),e.jsx("input",{type:"text",id:"location",name:"location",value:s.location,onChange:a,className:"mt-1 block w-full px-4 py-3 bg-white/5 border border-white/10 rounded-lg text-white placeholder-gray-500 focus:outline-none focus:border-indigo-500/50 focus:ring-1 focus:ring-indigo-500/30",placeholder:"City, Country"})]})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-sm border border-white/10 rounded-xl p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-white mb-4",children:"Resume / CV"}),k?e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-1 bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white",children:k}),e.jsxs("button",{type:"button",onClick:E,className:"flex items-center px-4 py-2 bg-red-500/20 border border-red-500/30 rounded-lg text-red-400 hover:bg-red-500/30 transition-all",children:[e.jsx(z,{size:16,className:"mr-2"}),"Remove"]}),e.jsxs("label",{htmlFor:"resume-upload",className:"flex items-center px-4 py-2 bg-indigo-500/20 border border-indigo-500/30 rounded-lg text-indigo-400 hover:bg-indigo-500/30 transition-all cursor-pointer",children:[e.jsx(p,{size:16,className:"mr-2"}),"Change",e.jsx("input",{id:"resume-upload",name:"resume-upload",type:"file",className:"sr-only",accept:".pdf,.doc,.docx",onChange:_})]})]}):e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"resume-upload",className:"flex items-center px-4 py-2 bg-indigo-500/20 border border-indigo-500/30 rounded-lg text-indigo-400 hover:bg-indigo-500/30 transition-all cursor-pointer inline-block",children:[e.jsx(p,{size:16,className:"mr-2"}),"Upload Resume / CV",e.jsx("input",{id:"resume-upload",name:"resume-upload",type:"file",className:"sr-only",accept:".pdf,.doc,.docx",onChange:_})]}),e.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Accepted formats: PDF, DOC, DOCX. Maximum file size: 10MB."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:N,className:"flex items-center px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-lg text-white font-medium hover:from-indigo-600 hover:to-purple-600 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:N?e.jsxs(e.Fragment,{children:[e.jsx(D,{size:20,className:"mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{size:20,className:"mr-2"}),"Save Profile"]})})})]})]})};export{X as default};
